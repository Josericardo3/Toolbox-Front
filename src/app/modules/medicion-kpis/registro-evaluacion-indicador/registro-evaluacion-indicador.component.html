<app-modal></app-modal>
<app-app-header  class="indicadores-app-header" ></app-app-header>
<div class="container-fluid">
  <div class="titulo">
    <h1>Evaluación Indicador</h1>
    <app-app-header-arrow-left
      [redirectToDashboard]="true"
    ></app-app-header-arrow-left>
  </div>
</div>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-3">
      <app-menu-medicion-kpis class="menu-oculto"></app-menu-medicion-kpis>
    </div>
    <mat-menu #menu="matMenu">
      <app-menu-medicion-kpis
        class="responsi-gerencia-menu"
      ></app-menu-medicion-kpis>
    </mat-menu>
    <div class="resposi-icon">
      <button mat-icon-button [matMenuTriggerFor]="menu" style="color: #ffffff">
        <i class="fa-solid fa-bars" style="font-size: 20px"></i>
      </button>
    </div>
    <div class="col-md-9">
      <div class="row">
        <div class="col-md-6" >
          <div class="form-group">
            <label for="norma">Norma</label>
            <select
            matNativeControl 
              [(ngModel)]="dataEnvio.ID_NORMA"
              name="norma"
              class="form-control custom-select"
              required
              (selectionChange)="cambiarNorma($event)"
            >
              <option
                *ngFor="let item of normas; let index = index"
                id="ID_NORMA-{{ index }}"
                [value]="item.ID_NORMA"
              >
                {{ item.NORMA }}
              </option>
            </select>
          </div>
          <!--<mat-form-field appearance="outline" class="matForm">
            <mat-label>Norma</mat-label>
            <mat-select
              [(ngModel)]="dataEnvio.ID_NORMA"
              name="norma"
              required
              (selectionChange)="cambiarNorma($event)"
            >
              <mat-option
                *ngFor="let item of normas; let index = index"
                id="ID_NORMA-{{ index }}"
                [value]="item.ID_NORMA"
              >
                {{ item.NORMA }}
              </mat-option>
            </mat-select>
          </mat-form-field>-->
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label for="paquete">Paquete</label>
            <select
              [(ngModel)]="dataEnvio.ID_PAQUETE"
              name="paquete"
              class="form-control"
              required
              (selectionChange)="cambiarPaquete($event)"
              (change)="cambiarPaquete($event)"
            >
            <option
               
                id="todos"
                [value]="0"
              >
                TODOS LOS PAQUETES
              </option>
              <option
                *ngFor="let item of dataPaquete; let index = index"
                id="ID_PAQUETE-{{ index }}"
                [value]="item.Id"
               
              >
                {{ item.Nombre }}
              </option>
            </select>
          </div>
         <!--
<mat-form-field appearance="outline" class="matForm">
            <mat-label>Paquete</mat-label>
            <mat-select
              [(ngModel)]="dataEnvio.ID_PAQUETE"
              name="paquete"
              required
              (selectionChange)="cambiarPaquete($event)"
            >
            <mat-option
               
                id="todos"
                [value]="0"
              >
                TODOS LOS PAQUETES
              </mat-option>
              <mat-option
                *ngFor="let item of dataPaquete; let index = index"
                id="ID_PAQUETE-{{ index }}"
                [value]="item.Id"
               
              >
                {{ item.Nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>
         --> 
        </div>
        <div class="col-md-2">
          <div style="text-align: right" class="mb-4">
            <!--
 <button class="btn-nuevo  " style="margin-bottom: 2rem;" (click)="aniadirIndicador(1, undefined)" data-toggle="modal" data-target="#exampleModal">Nuevo Indicador
                    <i class="fa-solid fa-plus" style="color: #fff;"></i>
                </button>
                -->
          </div>
        </div>
        <div class="col-md-12 col-sm-12  text-center">
          <div class="col-md-3"></div>
          <div class="col-md-6">
            <div class="form-group alinear-buscador" appearance="outline" >
              <mat-icon
                class="search-icon hand-pointer"
                style="color: #068460"
                matPrefix
                (click)="buscar()"
                >search</mat-icon
              >
              
              <input
                matInput
                [(ngModel)]="filter.search"
                class="form-control"
                placeholder="Ingresar título del Objetivo"
              />
              
            </div>
          </div>
          
          <!--<mat-form-field appearance="outline" style="width: 50%">
            <mat-label>Buscar</mat-label>
            <input
              matInput
              [(ngModel)]="filter.search"
              placeholder="Ingresar título del KPI"
            />
            <mat-icon
              class="search-icon hand-pointer"
              style="color: #068460"
              matPrefix
              (click)="buscar()"
              >search</mat-icon
            >
          </mat-form-field>-->
        </div>
      </div>

 
      <!--   <mat-tab-group
            
          >
          <mat-tab label="Lista de Indicadores">-->
      <div class="mat-elevation-z8 table-responsive text-center mt-1">
        <table mat-table [dataSource]="dataSource">
          <ng-container matColumnDef="paquete">
            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">
              Paquete
            </th>
            <td mat-cell *matCellDef="let element">
              {{ element.NOMBRE_PAQUETE }}
            </td>
          </ng-container>
          <ng-container matColumnDef="proceso">
            <th mat-header-cell *matHeaderCellDef class="mat-header-cell">
              Proceso
            </th>
            <td mat-cell *matCellDef="let element">
              {{ element.NOMBRE_PROCESO }}
            </td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Título</th>
            <td mat-cell *matCellDef="let element">
              {{ element.TITULO }}
            </td>
          </ng-container>

          <!--<ng-container matColumnDef="descripcion">
            <th mat-header-cell *matHeaderCellDef>Descripción</th>
            <td mat-cell *matCellDef="let element">
              {{ element.DESCRIPCION }}
            </td>
          </ng-container>-->
          <ng-container matColumnDef="calculo">
            <th mat-header-cell *matHeaderCellDef>Cálculo</th>
            <td mat-cell *matCellDef="let element">
              {{ element.FORMULA_TEXT }}
            </td>
          </ng-container>
          <ng-container matColumnDef="meta">
            <th mat-header-cell *matHeaderCellDef>Meta %</th>
            <td mat-cell *matCellDef="let element">
              {{ element.META }} 
            </td>
          </ng-container>
          <ng-container matColumnDef="periodo">
            <th mat-header-cell *matHeaderCellDef>Periodo Medición</th>
            <td mat-cell *matCellDef="let element">
              {{ element.NOMBRE_PERIODO }}
            </td>
          </ng-container>
          <ng-container matColumnDef="sem">
            <th mat-header-cell *matHeaderCellDef>META</th>
            <td mat-cell *matCellDef="let element">
              <div>
                <span class="dot-green"></span> >={{element.META}}  <span style="color:green">BUENO</span><br>
                <span class="dot-yellow"></span> >={{element.SEMAFORIZACION}}  <span style="color:yellow">REGULAR</span><br>
                <span class="dot-red"></span> <{{element.SEMAFORIZACION}}  <span style="color:red">MALO</span><br>
              </div>
            </td>
          </ng-container>
         
          <ng-container matColumnDef="opciones">
            <th class="text-center" mat-header-cell *matHeaderCellDef>
              Opciones
            </th>
            <td mat-cell *matCellDef="let element" class="text-center">
              <mat-icon class="search-icon hand-pointer"  matPrefix
              matTooltip="Detalle Evaluación"
              abrirDetalle
              (click)="abrirDetalle(element)"
              style="color: #068460"
                >search</mat-icon
              >
              <mat-icon
                matTooltip="Registrar Evaluacion"
                style="color: #068460"
                class="text-danger margen iconos hand-pointer"
                fontIcon="insert_chart"
                (click)="evaluarIndicador(2, element)"
              ></mat-icon>
              
            
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns"
            class="mat-header-row"
          ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>

       
      </div>
      <footer class="page-style">
        <div class="container-label">
          <label class="paginas">
            Página: {{ pages }} / {{ totalPaginas }} Mostrando:
            {{ dataSource.length }} Registros: {{ totalItems }}
          </label>
          <div class="ls-pagina">
            <pagination
              lastText="&raquo;"
              nextText="&rsaquo;"
              firstText="&laquo;"
              previousText="&lsaquo;"
              [maxSize]="3"
              [totalItems]="totalItems"
              [itemsPerPage]="pageSize"
              [(ngModel)]="currentPage"
              [boundaryLinks]="true"
              (pageChanged)="pageChanged($event)"
              [ngClass]="{ 'page-item': true }"
            >
            </pagination>
          </div>
        </div>
      </footer>
      <!--</mat-tab>
<mat-tab label="Indicadores Asignados">

          </mat-tab>
        </mat-tab-group>
         -->
    </div>
  </div>
</div>
<br />

<app-app-footer></app-app-footer>

<ngx-spinner
  bdColor="rgba(0, 0, 0, 0.5)"
  size="small"
  template="<img src='https://www.superiorlawncareusa.com/wp-content/uploads/2020/05/loading-gif-png-5.gif' width='50' height='50'/>"
>
</ngx-spinner>
